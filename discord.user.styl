/* ==UserStyle==
@name         Dark Discord
@namespace    gitlab.com/vednoc/dark-discord
@version      0.0.1
@description  Customizable dark theme for Discord.
@author       vednoc
@homepageURL  https://gitlab.com/vednoc/dark-discord
@supportURL   https://gitlab.com/vednoc/dark-discord/issues
@updateURL    https://gitlab.com/vednoc/dark-discord/raw/master/discord.user.styl
@preprocessor stylus

@var color dark    "Dark color.   " #2e2e2e
@var color darker  "Darker color. " #212121
@var color light   "Light color.  " #d1d1d1
@var color lighter "Lighter color." #e9e9e9
@var color icon    "Icon color.   " #e1e1e1
@var color accent  "Accent color. " #7289da
@var color yellow  "Yellow color. " #f0c674
@var color orange  "Orange color. " #de935f
@var color red     "Red color.    " #a54242
@var color magenta "Magenta color." #b294bb
@var color violet  "Violet color. " #85678f
@var color blue    "Blue color.   " #5f819d
@var color cyan    "Cyan color.   " #5e8d87
@var color green   "Green color.  " #8c9440
@var color shadow  "Shadow color. " #00000012

==/UserStyle== */

@-moz-document domain("discordapp.com") {
  :root {
    --dark    : dark;
    --darker  : darker;
    --light   : light;
    --lighter : lighter;
    --accent  : accent;
    --icon    : icon;
    --shadow  : shadow;
    --yellow  : yellow;
    --orange  : orange;
    --red     : red;
    --magenta : magenta;
    --violet  : violet;
    --blue    : blue;
    --cyan    : cyan;
    --green   : green;
    --t       : transparent !important;
  }

  // * Use stylus-lang variables with CSS variables.
  // TODO try to make this more compact.
  $dark    = var(--dark);
  $darker  = var(--darker);
  $light   = var(--light);
  $lighter = var(--lighter);
  $accent  = var(--accent);
  $icon    = var(--icon);
  $shadow  = var(--shadow);
  $yellow  = var(--yellow);
  $orange  = var(--orange);
  $red     = var(--red);
  $magenta = var(--magenta);
  $violet  = var(--violet);
  $blue    = var(--blue);
  $cyan    = var(--cyan);
  $green   = var(--green);
  $t       = var(--t);

  // * Color mixin.
  // ? All colors -> colors: $light, $darker, $dark;
  // ? Only background-color -> colors: 0, 0, $dark;
  colors(x, y, z) {
    if x is a 'call' { color: x !important; }
    if y is a 'call' { border-color: y !important; }
    if z is a 'call' { background-color: z !important; }
  }

  // * Global reset.
  ::placeholder { colors: $lighter, 0, 0; }
  [class^="chat"] ::-webkit-scrollbar {
    &-track { colors: 0, 0, $dark; }
    &-track-piece { colors: 0, $dark, $shadow; }
    &-thumb { colors: 0, $dark, $darker; }
  }
  // * Dirty firefox sidebar fix
  .scrollerWrap-2lJEkd {
    margin-right: -16px;
  }

  // * Loading page
  [class^="app"] > [class^="container"][class*="fixClipping"] { colors: 0, 0, $dark; }
  [class^="quote"] { colors: $light, 0, 0; }
  [class^="status"] { colors: $lighter, 0, 0; }

  // * Guilds.
  [class^="guildsWrapper"] {
    colors: 0, 0, $dark;
    [class^="friendsOnline"], [class^="download"] { colors: $lighter, 0, 0; }
  }

  // * Main area.
  [class*="base"] {
    // ? Make guild channels have transparent background.
    > [class*="spacer"] > [class*="channels"] > [class*="noWrap"] {
      colors: 0, 0, $t;
    }
    // ? Global channels.
    [class*="channels"] {
      colors: 0, 0, $darker;
    }

    // * User controls.
    [class^="channels"][class*="vertical"] > div:last-child {
      colors: $lighter, 0, $t;
      [class^="username"] { colors: $light, 0, 0; }
    }

    // * Chat section.
    [class*="chat"] {
      colors: 0, 0, $dark;
      > [class^="titleWrapper"] > [class*="title"] {
        colors: 0, 0, $darker;
        box-shadow: 0 1px 0 0 $shadow !important;
      }

      // ? Transparentize extra elements.
      // ! Careful with this; might need to be removed.
      > div {
        colors: 0, 0, $t;
        // Messages and input wrapper.
        [class^="messagesWrapper"] { colors: 0, 0, $t; }
        [class^="messagesWrapper"] + form { colors: 0, 0, $t; }
      }

      // * Messages.
      [class*="message-"] {
        // ? Style all but the ones that don't have OnHover class.
        [class*="timestampCompact"]:not([class*="OnHover"]) {
          opacity: 0.5;
          colors: $lighter, 0, 0;
        }
        // ? Apply styles regardless of class on every hover event.
        &:hover [class*="timestampCompact"] {
          opacity: 1;
          colors: $light, 0, 0;
        }
        [class*="edited"], [class*="timestampCozy"] { colors: $lighter, 0, 0; }
        [class^="username"], [class^="markup"] { colors: $light, 0, 0; }
        [class^="dividerEnabled"] { border-bottom-color: #FFFFFF08; }
        [class^="markup"] a { colors: $accent, 0, 0; }
      }

      // * Input section.
      [class^="channelTextArea"] {
        border-top-color: #FFFFFF08;
        // Input container.
        > [class^="inner"] { colors: 0, 0, $darker; }
      }

      // * Typing section.
      [class^="typing"] {
        colors: $light, 0, $t;
        [class^="text"], [class^="cooldownWrapper"] { colors: $lighter, 0, 0; }
        [class^="text"] strong { colors: $light, 0, 0; }
        [class^="ellipsis"] .spinner-item { colors: 0, 0, $light; }
      }

    }
  }
  
  // * Code chunks
  .markup-2BOw-j code, .markup-2BOw-j code.inline {
    background: $darker !important;
    color: $light !important;
  }
  .hljs {
    &-name, &-section, &-selector-class, &-selector-id, &-title {
      color: $blue !important;
    }
    &-attr, &-attribute, &-class , &-template-variable, &-type, &-variable {
      color: $orange !important;
    }
    &-built_in, &-deletion {
      color: $red !important;
    }
    &-doctag, &-literal, &-meta &-meta-string, &-number, &-regexp, &-string {
      color: $cyan !important;
    }
    &-addition, &-keyword, &-selector-tag {
      color: $green !important;
    }
    &-comment, &-quote {
      color: $light !important;
    }
  }

  // * Channel status
  .online-2S838R {
    background: $green !important;
  }
  .idle-3DEnRT {
    background: $orange !important;
  }
  .dnd-1_xrcq {
    background: $red !important;
  }

}
